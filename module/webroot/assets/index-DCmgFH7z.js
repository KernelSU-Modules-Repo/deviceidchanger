(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function a(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(e){if(e.ep)return;e.ep=!0;const o=a(e);fetch(e.href,o)}})();let N=0;function T(t){return`${t}_callback_${Date.now()}_${N++}`}function M(t,n){return typeof n>"u"&&(n={}),new Promise((a,s)=>{const e=T("exec");window[e]=(c,u,y)=>{a({errno:c,stdout:u,stderr:y}),o(e)};function o(c){delete window[c]}try{ksu.exec(t,JSON.stringify(n),e)}catch(c){s(c),o(e)}})}function L(t){ksu.toast(t)}function j(t){const a=new DOMParser().parseFromString(t,"text/xml"),s={};return a.querySelectorAll("setting").forEach(o=>{const c=o.getAttribute("value"),u=o.getAttribute("package");s[u]={ssaid:c,packageName:u,defaultValue:o.getAttribute("defaultValue"),defaultSysSet:o.getAttribute("defaultSysSet")==="true",tag:o.getAttribute("tag")}}),s}async function l(t){const{errno:n,stdout:a,stderr:s}=await M(t);if(n!=0){L(`stderr: ${s}`);return}else return a}function X(t){let n="";const a="abcdef0123456789";for(let s=0;s<t;s++){const e=Math.floor(Math.random()*a.length);n+=a.charAt(e)}return n}function F(t,n){return Math.floor(Math.random()*(n-t)+t)}function x(){return localStorage.getItem("ssa_uid")||"0"}function q(t){localStorage.setItem("ssa_uid",String(t))}async function H(){return[...(await l("cmd user list")).matchAll(/UserInfo\{(\d+):/g)].map(n=>n[1]).sort()}const f=document.querySelector("body"),S=["/wallpapers/frutiger-aero-wallpapers-1.jpg","/wallpapers/frutiger-aero-wallpapers-2.jpg","/wallpapers/frutiger-aero-wallpapers-3.jpg","/wallpapers/frutiger-aero-wallpapers-4.jpg","/wallpapers/frutiger-aero-wallpapers-5.jpg"],_=S[F(0,S.length)];console.log(`Background image set to: ${_}`);f.style.backgroundImage=`url('${_}')`;f.style.backgroundRepeat="no-repeat";f.style.backgroundAttachment="fixed";f.style.backgroundSize="cover";f.style.backgroundPosition="center";const R="/data/adb/modules/deviceidchanger",k="/sdcard/settings_ssaid.xml";await l("uname -m");async function A(t){const n=`/data/system/users/${t}/settings_ssaid.xml`,a=`${R}/tmp/settings_ssaid.u${t}.xml`,s=await l(`file ${n}`);console.log(`SSAID file check result for UID ${t}: ${s}`);const e=!!s.includes("ASCII text");console.log(`Is SSAID file ABX for UID ${t}: ${e}`);const o=e?await l(`cat ${n}`):await l(`abx2xml ${n} ${a}; cat ${a}`);console.log(`XML data loaded from: ${e?n:a}`);const c=j(o.toString());return console.log("Parsed settings for UID",t,":",c),{settingsObject:c,isnotABX:e,currentSsaidLocation:n,currentAbxSsaidLocation:a}}let{settingsObject:d,isnotABX:B,currentSsaidLocation:z,currentAbxSsaidLocation:V}=await A(x()),m=z,w=V;var v=!1;function D(t,n){for(;t.children.length>1;)t.removeChild(t.lastChild);for(const[a,{ssaid:s}]of Object.entries(n)){if(a==="android")continue;const e=document.createElement("option");e.value=s,e.textContent=a,t.appendChild(e)}}async function J(t,n,a,s){try{const e=await A(t);d=e.settingsObject,B=e.isnotABX,m=e.currentSsaidLocation,w=e.currentAbxSsaidLocation,D(n,d),a.value="",s.value="",console.log(`Successfully updated settings for UID: ${t}`)}catch(e){console.error(`Error updating settings for UID ${t}:`,e),L(`Error loading settings for UID ${t}: ${e.message}`)}}async function K(){const t=document.getElementById("uid-select"),n=document.getElementById("app-pkg");var a=document.getElementById("ssaid-value");const s=document.getElementById("balloon-text"),e=document.getElementById("randomize-ssaid"),o=document.getElementById("apply-ssaid"),c=document.getElementById("default-ssaid"),u=document.getElementById("about-window"),y=document.getElementById("open-about"),C=document.getElementById("close-about"),p=document.getElementById("dialog-div"),E=document.getElementById("dialog-msg"),O=document.getElementById("dialog-close1"),b=document.getElementById("dialog-close2"),P=document.getElementById("backup-settings"),h=document.getElementById("donate-window"),U=document.getElementById("open-donate"),I=document.getElementById("close-donate");var g={value:""};(await H()).forEach(r=>{const i=document.createElement("option");i.value=i.textContent=r,r===x()&&(i.selected=!0),t.appendChild(i)}),t.addEventListener("change",async r=>{q(r.target.value),await J(r.target.value,n,a,g)}),D(n,d),n.addEventListener("click",r=>{r.preventDefault()}),n.addEventListener("change",r=>{var i=r.target.value,$=r.target.options[r.target.selectedIndex].textContent;console.log($,": ",i),a.value=i,g.value=$}),e.addEventListener("click",()=>{a.value=X(16)}),c.addEventListener("click",()=>{g.value&&d[g.value]&&(a.value=d[g.value].defaultValue)}),o.addEventListener("click",async()=>{var r=a.value,i=n.options[n.selectedIndex].textContent;r.match(/^[0-9a-f]+$/i)&&r.length==16?(console.log(`Applying SSAID: ${r} for package: ${i}`),B?await l(`sed -i 's/value="${d[i].ssaid}"/value="${r}"/' ${m}`):(await l(`sed -i 's/value="${d[i].ssaid}"/value="${r}"/' ${w}`),await l(`xml2abx ${w} ${m}`)),await l(`chmod 600 ${m}`),d[i].ssaid=r,E.innerHTML=`SSAID for <b>${i}</b> changed to <b>${r}</b>`,b.innerHTML="Reboot",v=!0,p.hidden=!1):(s.hidden=!1,setTimeout(()=>{s.hidden=!0},5e3))}),P.addEventListener("click",async()=>{await l(`cp ${m} ${k}`),E.innerHTML=`Backup created at <b>${k}</b>`,b.innerHTML="Close",v=!1,p.hidden=!1}),y.addEventListener("click",()=>{u.hidden=!1}),C.addEventListener("click",()=>{setTimeout(()=>{u.hidden=!0},100)}),O.addEventListener("click",()=>{setTimeout(()=>{p.hidden=!0},100)}),b.addEventListener("click",()=>{setTimeout(async()=>{v&&await l("reboot"),p.hidden=!0},100)}),U.addEventListener("click",()=>{h.hidden=!1}),I.addEventListener("click",()=>{setTimeout(()=>{h.hidden=!0},100)}),I.addEventListener("click",()=>{setTimeout(()=>{h.hidden=!0},100)})}K();
